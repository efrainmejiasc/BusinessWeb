@{
    ViewBag.Title = "About";
}

@*  1021933909  *@

<br />
<div class="row">
    <div class="offset-4 col-md-4">

        <div class="text-center">
            <h4>Ver Carnet</h4>
        </div>

        <div class="form-group">
            <div class="col-12">
                <input type="text" id="dni" name="dni" placeholder="Ingrese Documento de Identidad" required class="form-control" />
            </div>
        </div>
        <div class="form-group">
            <div class="col-12">
                <div class="row">
                    <div class="col-6">
                        <input type="submit" id="buscar" value="Buscar" class="voton btn btn-primary" onclick="BuscarCarnet();" />
                    </div>
                    <div class="col-6 text-right">
                        <input type="reset" id="cancelar" value="Cancelar" onClick="NavePage('/Home/Index');" class="voton btn btn-primary" />
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div id="myModal" class="modal" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" onclick="CerrarModal();">&times;</button>
                    </div>
                    <div class="modal-body">
                        <img id="carnet" class="imgCarnet" style="width:100%;" alt="No posee imagen">
                    </div>
                </div>
            </div>
        </div>

        @*<div id="myModal" class="modal">
            <div class="modal-content" style="width:50%;">
                <div style="float:right;">
                    <span id="cerrar" class="close" onclick="CerrarModal();">&times;</span>
                </div><br />
                <img id="carnet" class="imgCarnet" style="width:50%;" alt="No posee imagen">

            </div>
        </div>*@
    </div>
</div>

@section Scripts{
    <script>
    $(document).ready(function () {
        OcultarMenu();
        OcultarIcons();
        $('#footerPage').removeClass('footerPage');
        document.documentElement.style.overflowX = 'hidden';
        let respuesta = '@ViewBag.Response';
        if (respuesta != '') {
          alert(respuesta);
        }
  });


    function BuscarCarnet()
    {
      var dni = $('#dni').val();
        if (dni === '')
        {
           alert('Ingrese numero de documento de identidad');
           return false;
        }

        $('#carnet'). attr("src", "http://joselelu-001-site2.etempurl.com/digitalcard/" + dni + ".jpg");
        MostrarModal();
    }


function BuscarPersona() {
    var dni = $('#dni').val();

    if (dni === '') {
        alert('Ingrese numero de documento de identidad');
        return false;
    }

    $.ajax({
        type: "POST",
        url: "/Procesor/BuscarPersona",
        data: {dni: dni},
        datatype: "json",
        success: function (data) {
            console.log(data);
            if (data == "NO AUTORIZADO") {
                alert("Sesion expirada , debe volver a autentificarse")
                NavePage('/Home/Index')
            }
            try {
                var I = JSON.parse(data);
                $('#nombre').html(I.Nombre);
                $('#apellido').html(I.Apellido);
                $('#di').html(I.Dni);
                $('#matricula').html(I.Matricula);
                $('#grado').html(I.Grado);
                $('#grupo').html(I.Grupo);
                $('#rh').html(I.Rh);
                document.getElementById('alumno').setAttribute('src', 'data:image/png;base64,' + I.Foto);
                document.getElementById('qr').setAttribute('src', 'data:image/png;base64,' + I.Qr);
                MostrarModal();
            } catch(error){ alert('Numero documento identidad ' + dni + ' no encontrado');}

        },
        complete: function () {

            console.log('BUSCARPERSONA');
        }
    });
}
    </script>
}
